Search.setIndex({"docnames": ["README", "belt_nlp", "bert_for_longer_texts", "index", "modules"], "filenames": ["README.md", "belt_nlp.rst", "bert_for_longer_texts.md", "index.rst", "modules.rst"], "titles": ["Installing dependencies", "belt_nlp package", "BERT modification for longer texts", "Welcome to BELT (BERT For Longer Texts)\u2019s documentation!", "belt_nlp"], "terms": {"On": 0, "top": 0, "project": 0, "addit": [0, 2, 3], "doc": 0, "pip": 0, "r": 0, "sphinx": 0, "requir": 0, "txt": 0, "gener": 0, "build": 0, "start": 0, "simpl": 0, "http": [0, 1], "server": 0, "python": 0, "m": 0, "directori": 0, "open": 0, "0": [0, 1], "8000": 0, "make": [0, 1, 2, 3], "sure": [0, 1], "you": 0, "ar": [0, 1, 2, 3], "gh": 0, "page": [0, 3], "branch": 0, "add": [0, 1, 2, 3], "commit": 0, "push": 0, "chang": [0, 2, 3], "class": [1, 2, 3], "bertclassifi": [1, 4], "batch_siz": [1, 2, 3], "int": 1, "learning_r": 1, "float": 1, "epoch": 1, "token": [1, 2, 3], "pretrainedtokenizerbas": 1, "none": [1, 2, 3], "neural_network": 1, "pretrained_model_name_or_path": 1, "str": 1, "base": [1, 2, 3], "uncas": 1, "devic": 1, "cuda": 1, "many_gpu": 1, "bool": 1, "fals": 1, "abc": 1, "The": [1, 2, 3], "paramet": [1, 2, 3], "can": [1, 2, 3], "have": 1, "follow": [1, 2, 3], "valu": 1, "cpu": 1, "model": 1, "load": [1, 4], "singl": 1, "gpu": [1, 2, 3], "i": [1, 2, 3], "specif": 1, "index": [1, 3], "It": [1, 2, 3], "also": 1, "possibl": 1, "us": [1, 2, 3], "multipl": 1, "In": [1, 2, 3], "order": 1, "do": [1, 2, 3], "thi": [1, 2, 3], "set": [1, 2, 3], "flag": 1, "true": 1, "As": 1, "default": [1, 2, 3], "all": [1, 2, 3], "them": 1, "To": 1, "onli": [1, 2, 3], "select": 1, "environment": 1, "variabl": [1, 2, 3], "cuda_visible_devic": 1, "fit": [1, 2, 3, 4], "x_train": 1, "list": [1, 2, 3], "y_train": 1, "classmethod": 1, "model_dir": 1, "predict": [1, 4], "x": 1, "tupl": 1, "predict_class": [1, 4], "predict_scor": [1, 4], "save": [1, 4], "bertclassifiernn": [1, 4], "bertmodel": 1, "robertamodel": 1, "forward": [1, 4], "input_id": 1, "tensor": [1, 2, 3], "attention_mask": 1, "defin": 1, "comput": 1, "perform": 1, "everi": 1, "call": 1, "should": 1, "overridden": 1, "subclass": 1, "although": 1, "recip": 1, "pass": 1, "need": [1, 2, 3], "within": 1, "function": [1, 2, 3], "one": [1, 2, 3], "instanc": 1, "afterward": 1, "instead": 1, "sinc": 1, "former": 1, "take": 1, "care": 1, "run": 1, "regist": 1, "hook": 1, "while": 1, "latter": 1, "silent": 1, "ignor": [1, 2, 3], "tokenizeddataset": [1, 4], "batchencod": 1, "label": 1, "dataset": 1, "option": 1, "bertclassifiertrunc": [1, 4], "bertclassifierwithpool": [1, 2, 3, 4], "chunk_siz": [1, 2, 3], "stride": [1, 2, 3], "minimal_chunk_length": [1, 2, 3], "pooling_strategi": [1, 2, 3], "mean": [1, 2, 3], "maximal_text_length": [1, 2, 3], "procedur": [1, 2, 3], "whole": [1, 2, 3], "text": 1, "truncat": [1, 2, 3], "size": [1, 2, 3], "chunk": [1, 2, 3], "mai": [1, 2, 3], "overlap": [1, 2, 3], "depend": [1, 2, 3], "other": [1, 2, 3], "word": [1, 2, 3], "we": [1, 2, 3], "get": [1, 2, 3], "move": [1, 2, 3], "window": [1, 2, 3], "length": [1, 2, 3], "equal": [1, 2, 3], "see": [1, 2, 3], "exampl": [1, 2, 3], "github": 1, "com": 1, "googl": 1, "research": 1, "issu": [1, 2, 3], "27": 1, "issuecom": 1, "435265194": 1, "ha": [1, 2, 3], "analog": [1, 2, 3], "here": [1, 2, 3], "convolut": [1, 2, 3], "neural": [1, 2, 3], "network": [1, 2, 3], "kernel_s": [1, 2, 3], "cnn": [1, 2, 3], "which": [1, 2, 3], "too": [1, 2, 3], "small": [1, 2, 3], "smaller": [1, 2, 3], "than": [1, 2, 3], "after": [1, 2, 3], "pool": [1, 2, 3], "aggreg": [1, 2, 3], "specifi": 1, "string": [1, 2, 3], "either": [1, 2, 3], "max": [1, 2, 3], "static": 1, "collate_fn_pooled_token": [1, 4], "data": 1, "inconsistentsplittingparamsexcept": [1, 4], "add_padding_token": [1, 4], "input_id_chunk": 1, "torch": [1, 2, 3], "mask_chunk": 1, "pad": [1, 2, 3], "id": 1, "end": [1, 2, 3], "exactli": 1, "512": [1, 2, 3], "add_special_tokens_at_beginning_and_end": [1, 4], "special": [1, 2, 3], "cl": 1, "101": 1, "begin": [1, 2, 3], "sep": 1, "102": 1, "each": [1, 2, 3], "correspond": 1, "attent": 1, "mask": 1, "1": 1, "boolean": 1, "check_split_parameters_consist": [1, 4], "split_overlap": [1, 4], "helper": 1, "divid": 1, "dimension": 1, "split_tokens_into_smaller_chunk": [1, 4], "given": [1, 2, 3], "stack_tokens_from_all_chunk": [1, 4], "reshap": 1, "form": 1, "compat": 1, "input": [1, 2, 3], "tokenize_text_with_trunc": [1, 4], "without": 1, "tokenize_whole_text": [1, 4], "entir": 1, "transform_list_of_text": [1, 4], "transform_single_text": [1, 4], "transform": [1, 2, 3], "list_of_tensors_deep_equ": [1, 4], "list_1": 1, "list_2": 1, "maxim": [2, 3], "roughli": [2, 3], "speak": [2, 3], "built": [2, 3], "architectur": [2, 3], "cannot": [2, 3], "directli": [2, 3], "discuss": [2, 3], "found": [2, 3], "overcom": [2, 3], "wa": [2, 3], "propos": [2, 3], "devlin": [2, 3], "author": [2, 3], "previous": [2, 3], "mention": [2, 3], "comment": [2, 3], "split": [2, 3, 4], "determin": [2, 3], "hyperparamet": [2, 3], "These": [2, 3], "thei": [2, 3], "wai": [2, 3], "an": [2, 3], "integ": [2, 3], "number": [2, 3], "consid": [2, 3], "standard": [2, 3], "510": [2, 3], "becaus": [2, 3], "larger": [2, 3], "otherwis": [2, 3], "abl": [2, 3], "bigger": [2, 3], "must": [2, 3], "1d": [2, 3], "aforement": [2, 3], "more": [2, 3], "differ": [2, 3], "test_split": [2, 3], "result": [2, 3], "instruct": [2, 3], "main": [2, 3], "allow": [2, 3], "For": 2, "sequenc": [2, 3], "same": [2, 3], "stack": [2, 3], "via": [2, 3], "fed": [2, 3], "mini": [2, 3], "batch": [2, 3], "n": [2, 3], "probabl": [2, 3], "obtain": [2, 3], "final": [2, 3], "maximum": [2, 3], "dure": [2, 3], "train": [1, 2, 3, 4], "step": [2, 3], "abov": [2, 3], "crucial": [2, 3], "part": [2, 3], "oper": [2, 3], "type": [2, 3], "cat": [2, 3], "done": [2, 3], "attach": [2, 3], "gradient": [2, 3], "That": [2, 3], "ani": [2, 3], "intermedi": [2, 3], "convers": [2, 3], "arrai": [2, 3], "backpropag": [2, 3], "command": [2, 3], "loss": [2, 3], "backward": [2, 3], "won": [2, 3], "t": [2, 3], "work": [2, 3], "precis": [2, 3], "overrid": [2, 3], "loop": [2, 3], "_evaluate_single_batch": [2, 3], "bert_with_pool": [2, 3, 4], "py": [2, 3], "dataload": [2, 3], "automat": [2, 3], "want": [2, 3], "why": [2, 3], "creat": [2, 3], "custom": [2, 3], "overwritten": [2, 3], "collate_fn": [2, 3], "detail": [2, 3], "lot": [2, 3], "memori": [2, 3], "even": [2, 3], "case": [2, 3], "recommend": [2, 3], "natur": [2, 3], "trade": [2, 3], "off": [2, 3], "between": [2, 3], "context": [2, 3], "look": [2, 3], "avail": [2, 3], "resourc": [2, 3], "equival": [2, 3], "belt_nlp": 3, "packag": [3, 4], "search": 3, "submodul": 4, "bert": 4, "modul": 4, "bert_trunc": 4, "except": 4, "tensor_util": 4, "content": 4}, "objects": {"": [[1, 0, 0, "-", "belt_nlp"]], "belt_nlp": [[1, 0, 0, "-", "bert"], [1, 0, 0, "-", "bert_truncated"], [1, 0, 0, "-", "bert_with_pooling"], [1, 0, 0, "-", "exceptions"], [1, 0, 0, "-", "splitting"], [1, 0, 0, "-", "tensor_utils"]], "belt_nlp.bert": [[1, 1, 1, "", "BertClassifier"], [1, 1, 1, "", "BertClassifierNN"], [1, 1, 1, "", "TokenizedDataset"]], "belt_nlp.bert.BertClassifier": [[1, 2, 1, "", "fit"], [1, 2, 1, "", "load"], [1, 2, 1, "", "predict"], [1, 2, 1, "", "predict_classes"], [1, 2, 1, "", "predict_scores"], [1, 2, 1, "", "save"]], "belt_nlp.bert.BertClassifierNN": [[1, 2, 1, "", "forward"], [1, 3, 1, "", "training"]], "belt_nlp.bert_truncated": [[1, 1, 1, "", "BertClassifierTruncated"]], "belt_nlp.bert_with_pooling": [[1, 1, 1, "", "BertClassifierWithPooling"]], "belt_nlp.bert_with_pooling.BertClassifierWithPooling": [[1, 2, 1, "", "collate_fn_pooled_tokens"]], "belt_nlp.exceptions": [[1, 4, 1, "", "InconsistentSplittingParamsException"]], "belt_nlp.splitting": [[1, 5, 1, "", "add_padding_tokens"], [1, 5, 1, "", "add_special_tokens_at_beginning_and_end"], [1, 5, 1, "", "check_split_parameters_consistency"], [1, 5, 1, "", "split_overlapping"], [1, 5, 1, "", "split_tokens_into_smaller_chunks"], [1, 5, 1, "", "stack_tokens_from_all_chunks"], [1, 5, 1, "", "tokenize_text_with_truncation"], [1, 5, 1, "", "tokenize_whole_text"], [1, 5, 1, "", "transform_list_of_texts"], [1, 5, 1, "", "transform_single_text"]], "belt_nlp.tensor_utils": [[1, 5, 1, "", "list_of_tensors_deep_equal"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:exception", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "exception", "Python exception"], "5": ["py", "function", "Python function"]}, "titleterms": {"instal": 0, "depend": 0, "test": 0, "local": 0, "publish": 0, "belt_nlp": [1, 4], "packag": 1, "submodul": 1, "bert": [1, 2, 3], "modul": 1, "bert_trunc": 1, "bert_with_pool": 1, "except": 1, "split": 1, "tensor_util": 1, "content": [1, 3], "modif": [2, 3], "longer": [2, 3], "text": [2, 3], "motiv": [2, 3], "method": [2, 3], "1": [2, 3], "prepar": [2, 3], "singl": [2, 3], "2": [2, 3], "model": [2, 3], "evalu": [2, 3], "3": [2, 3], "fine": [2, 3], "tune": [2, 3], "classifi": [2, 3], "remark": [2, 3], "welcom": 3, "belt": 3, "For": 3, "": 3, "document": 3, "indic": 3, "tabl": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Installing dependencies": [[0, "installing-dependencies"]], "Testing locally": [[0, "testing-locally"]], "Publishing": [[0, "publishing"]], "belt_nlp package": [[1, "belt-nlp-package"]], "Submodules": [[1, "submodules"]], "belt_nlp.bert module": [[1, "module-belt_nlp.bert"]], "belt_nlp.bert_truncated module": [[1, "module-belt_nlp.bert_truncated"]], "belt_nlp.bert_with_pooling module": [[1, "module-belt_nlp.bert_with_pooling"]], "belt_nlp.exceptions module": [[1, "module-belt_nlp.exceptions"]], "belt_nlp.splitting module": [[1, "module-belt_nlp.splitting"]], "belt_nlp.tensor_utils module": [[1, "module-belt_nlp.tensor_utils"]], "Module contents": [[1, "module-belt_nlp"]], "belt_nlp": [[4, "belt-nlp"]], "BERT modification for longer texts": [[2, "bert-modification-for-longer-texts"], [3, "bert-modification-for-longer-texts"]], "Motivation": [[2, "motivation"], [3, "motivation"]], "Method": [[2, "method"], [3, "method"]], "1. Preparing a single text": [[2, "preparing-a-single-text"], [3, "preparing-a-single-text"]], "2. Model evaluation": [[2, "model-evaluation"], [3, "model-evaluation"]], "3. Fine-tuning the classifier": [[2, "fine-tuning-the-classifier"], [3, "fine-tuning-the-classifier"]], "Remarks": [[2, "remarks"], [3, "remarks"]], "Welcome to BELT (BERT For Longer Texts)\u2019s documentation!": [[3, "welcome-to-belt-bert-for-longer-texts-s-documentation"]], "Contents:": [[3, null]], "Indices and tables": [[3, "indices-and-tables"]]}, "indexentries": {}})